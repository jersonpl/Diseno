{"ast":null,"code":"import dbConnections from './db.Connections';\nimport express from 'express';\nvar router = express.Router();\nimport dgram from 'dgram';\nvar server = dgram.createSocket('udp4');\nvar app = express();\nserver.on('error', function (err) {\n  console.log(\"server error:\\n\".concat(err.stack));\n  server.close();\n});\nserver.on('message', function (msg, rinfo) {\n  var mes = msg.toString();\n  var con = dbConnections();\n  var sql = \"INSERT INTO `syrus` (`ID`, `Fecha`, `Latitud`, `Longitud`) VALUES ?;\";\n  console.log(mes.substring(1, 4));\n\n  if (mes.substring(1, 4) == \"REV\") {\n    var semanas = mes.substring(6, 10);\n    var semana = parseInt(semanas);\n    var dia = mes.substring(10, 11);\n    var dian = parseInt(dia);\n    var hora = mes.substring(11, 16);\n    var horan = parseInt(hora);\n    var semanan = (semana * 604800 + horan + 315964800 + dian * 86400 - 18000) * 1000;\n    var todo = new Date(semanan).toISOString().replace(/T/, ' ').replace(/\\..+/, '');\n    var latitud = mes.substring(17, 19) + \".\" + mes.substring(19, 24);\n    var longitud = mes.substring(24, 25) + mes.substring(26, 28) + \".\" + mes.substring(28, 33);\n    console.log(\"Fecha: \", todo, \"latitud: \", latitud, \"longitud: \", longitud);\n  }\n\n  values = [['NULL', todo, latitud, longitud]];\n  con.query(sql, [values], function (err, result) {\n    if (err) throw err;\n    console.log(\"Number of records inserted: \" + result.affectedRows);\n  });\n});\nserver.bind(45826); //>REV442039316285+0000000-0748686700014612;ID=357042062915567<\n\nrefresh = function refresh() {\n  var con = dbConnections();\n  con.query('SELECT * FROM syrus order by ID desc limit 1', [], function (err, result) {\n    datos: result;\n  });\n};\n\nsetInterval(refresh, 1000); //module.exports = router;\n\nexports.datos = datos;","map":{"version":3,"sources":["C:\\Users\\jerso\\Google Drive\\Uninorte\\9. Noveno\\Diseño Electrónico\\Proyecto 2\\webreact\\src\\datos.js"],"names":["dbConnections","express","router","Router","dgram","server","createSocket","app","on","err","console","log","stack","close","msg","rinfo","mes","toString","con","sql","substring","semanas","semana","parseInt","dia","dian","hora","horan","semanan","todo","Date","toISOString","replace","latitud","longitud","values","query","result","affectedRows","bind","refresh","datos","setInterval","exports"],"mappings":"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","sourcesContent":["import dbConnections from './db.Connections';\r\nimport express from 'express';\r\nvar router = express.Router();\r\nimport dgram from 'dgram';\r\nvar server = dgram.createSocket('udp4');\r\nconst app = express();\r\n\r\n\r\nserver.on('error', (err) => {\r\n    console.log(`server error:\\n${err.stack}`);\r\n    server.close();\r\n});\r\n\r\nserver.on('message', (msg, rinfo) => {\r\n    var mes = msg.toString();\r\n    var con = dbConnections();\r\n    var sql = \"INSERT INTO `syrus` (`ID`, `Fecha`, `Latitud`, `Longitud`) VALUES ?;\";\r\n    console.log(mes.substring(1, 4));\r\n    if (mes.substring(1, 4) == \"REV\") {\r\n        var semanas = mes.substring(6, 10);\r\n        var semana = parseInt(semanas);\r\n        var dia = mes.substring(10, 11);\r\n        var dian = parseInt(dia);\r\n        var hora = mes.substring(11, 16);\r\n        var horan = parseInt(hora);\r\n        var semanan = (semana * 604800 + horan + 315964800 + dian * 86400 - 18000) * 1000;\r\n        var todo = new Date(semanan).toISOString().replace(/T/, ' ').replace(/\\..+/, '');\r\n        var latitud = mes.substring(17, 19) + \".\" + mes.substring(19, 24);\r\n        var longitud = mes.substring(24, 25) + mes.substring(26, 28) + \".\" + mes.substring(28, 33);\r\n        console.log(\"Fecha: \", todo, \"latitud: \", latitud, \"longitud: \", longitud);\r\n    }\r\n    values = [['NULL', todo, latitud, longitud]];\r\n    con.query(sql, [values], function (err, result) {\r\n        if (err) throw err;\r\n        console.log(\"Number of records inserted: \" + result.affectedRows);\r\n    });\r\n});\r\n\r\nserver.bind(45826);\r\n\r\n//>REV442039316285+0000000-0748686700014612;ID=357042062915567<\r\nrefresh = function () {\r\n    var con = dbConnections();\r\n    con.query('SELECT * FROM syrus order by ID desc limit 1', [], function (err, result) {\r\n        datos: result\r\n    })\r\n\r\n}\r\nsetInterval(refresh, 1000);\r\n//module.exports = router;\r\nexports.datos = datos;"]},"metadata":{},"sourceType":"module"}